## A - Job Shop Scheduling

### ストーリー

とある工場では、多品種少量生産のために「ジョブ（製品）」ごとに異なる工程順序で機械を使って加工している。
各ジョブは複数の工程（オペレーション）からなり、工程には使用機械と加工時間が定められている。
工場長のあなたは、すべてのジョブができるだけ早く完了するように、各機械で処理する工程の順番を決めたい。


## 問題文

機械が $M$ 台、ジョブが $J$ 個ある。
各ジョブ $j$（$0 \le j < J$）はちょうど $M$ 個の工程からなり、工程 $k$（$0 \le k < M$）は

* 使用機械 $a_{j,k}$（$0 \le a_{j,k} < M$）
* 加工時間 $p_{j,k}$（正の整数）

で表される。

各ジョブ $j$ について、工程は $k=0,1,\dots,M-1$ の順に **必ず** 実行されなければならない（先行制約）。
また、各機械は同時に 1 つの工程しか処理できない（資源制約）。工程は **中断不可**（preemption なし）である。
すべての工程は時刻 $0$ 以降に開始し、開始・終了時刻は実数（double 相当）として扱うものとする（ただし入力は整数）。

あなたの出力は、各機械 $m$ について、その機械で処理される工程の **処理順序** である。
ジャッジは、あなたの指定した順序を満たしつつ、各工程を可能な限り早く開始する **最早開始スケジューリング** により開始時刻を一意に定める：

* 機械 $m$ 上の順序で直前に処理された工程の終了時刻
* 同じジョブ内の直前工程の終了時刻

の最大を開始時刻とし、加工時間だけ処理する。

このとき、全工程の終了時刻の最大値（メイクスパン）
$$
C_{\max}=\max_{j,k} \text{(工程 }(j,k)\text{ の終了時刻)}
$$
をできるだけ小さくせよ。


## 得点

各テストケースに対し、以下の下界（Lower Bound）を定義する：

* ジョブ下界
  $$
  LB_{\text{job}}=\max_{j}\sum_{k=0}^{M-1}p_{j,k}
  $$
* 機械下界
  機械 $m$ に割り当てられる全工程集合を $S_m={(j,k)\mid a_{j,k}=m}$ とし、
  $$
  LB_{\text{mac}}=\max_{m}\sum_{(j,k)\in S_m}p_{j,k}
  $$
* 下界
  $$
  LB=\max(LB_{\text{job}},LB_{\text{mac}})
  $$

あなたの出力から計算されたメイクスパンを $C_{max}$ とすると、得点は
$$
\mathrm{Score}=\mathrm{round}\left(10^{6}\times \frac{LB}{C_{\max}}\right)
$$
で与えられる。得点は大きいほど良い。

以下の場合、当該テストケースは WA となる：

* 出力形式が不正な場合
* ある機械に対して、同じ工程を複数回出力した／必要な工程を出力しなかった場合
* 指定された順序が工程集合と矛盾する場合（例：機械 $m$ に属さない工程を含めた等）

テストケースは合計で $T$ 個あり、提出の得点は **各テストケースの得点合計** である。
いずれか 1 ケースでも WA/TLE となった場合、提出全体が WA/TLE となる。


## 入力

入力は以下の形式で標準入力から与えられる。

$$
J\ M \\
a_{0,0}\ a_{0,1}\ \dots\ a_{0,M-1} \\
a_{1,0}\ a_{1,1}\ \dots\ a_{1,M-1} \\
\vdots \\
a_{J-1,0}\ a_{J-1,1}\ \dots\ a_{J-1,M-1} \\
p_{0,0}\ p_{0,1}\ \dots\ p_{0,M-1} \\
p_{1,0}\ p_{1,1}\ \dots\ p_{1,M-1} \\
\vdots \\
p_{J-1,0}\ p_{J-1,1}\ \dots\ p_{J-1,M-1} \\
$$

* 各テストケースで $J, M$ は固定（後述の制約参照）
- 各テストケースは次の順で与えられる:
  - まず、ジョブごとに a_{j,k} が与えられる（各行に M 個）
  - 次に、ジョブごとに p_{j,k} が与えられる（各行に M 個）


## 出力

各機械の順序を以下のとおりに出力せよ：

* $M$ 行出力する。$m$ 行目（0-index ではなく **出力上の順番**）には、機械 $m$ で処理される全工程を、処理順に列挙する。

工程の表現は `(j,k)` を **2つの整数** `j k` として表す。
機械 $m$ に属する工程数を $|S_m|$ とすると、機械 $m$ の行は次の形式：

$$
j_1 k_1  j_2 k_2  \dots  j_|S_m| k_|S_m|
$$

ここで $(j_t,k_t)\in S_m$ がすべてちょうど 1 回ずつ現れなければならない。


## 制約（本問題設定）

各テストケースで以下を満たす：

* $J = 50$
* $M = 20$
* 各ジョブはちょうど $M$ 工程を持つ
* 各ジョブ内で ${a_{j,k}}_{k=0}^{M-1}$ は $0..M-1$ の **置換**（同一機械を 2 回使わない）
* $1 \le p_{j,k} \le 100$


## 入力生成方法

$\mathrm{rand}(L,U)$ を「$L$ 以上 $U$ 以下の整数を一様ランダムに生成する関数」とする。

各テストケースについて：

1. $J=50, M=20$ とする。
2. 各ジョブ $j$ について

  * 機械列 $(a_{j,0},\dots,a_{j,M-1})$ は $0..M-1$ の一様ランダムな置換
  * 各 $k$ について $p_{j,k}=\mathrm{rand}(1,100)$


## 参考：ジャッジによるスケジューリング（概念）

あなたの出力が与える「機械ごとの工程列」を用い、各工程 $(j,k)$ の開始時刻 $s_{j,k}$ は

* 同一ジョブ直前工程の終了時刻 $c_{j,k-1}$（$k=0$ なら 0）
* 同一機械で直前に並ぶ工程の終了時刻

の最大として決定され、終了時刻 $c_{j,k}=s_{j,k}+p_{j,k}$ とする。


## 入力例（形式例）

（以下は形式例であり、実際のパラメータ $J=50, M=20$ より小さくしている。）

### 入力例

```
2 3
0 2 1
2 1 0
5 4 3
2 6 1
```

### 出力例

```
0 0 1 2
0 2 1 1
0 1 1 0
```


## ツール（入力ジェネレータ・ビジュアライザ）

* ブラウザ上でスケジュールを可視化し、メイクスパンやガントチャートを表示できる。入力生成・スコア計算・可視化を行う。
